create database if not exists ${DB};
use ${DB};

drop table if exists lineitem;
create table lineitem (
L_ORDERKEY BIGINT,
L_PARTKEY BIGINT,
L_SUPPKEY BIGINT,
L_LINENUMBER INT,
L_QUANTITY decimal(7,2),
L_EXTENDEDPRICE decimal(7,2),
L_DISCOUNT decimal(7,2),
L_TAX decimal(7,2),
L_RETURNFLAG char(1),
L_LINESTATUS char(1),
L_COMMITDATE DATE,
L_RECEIPTDATE DATE,
L_SHIPINSTRUCT char(25),
L_SHIPMODE char(10),
L_COMMENT varchar(44))
partitioned by (L_SHIPDATE DATE)
stored as ${FILE};

INSERT OVERWRITE TABLE lineitem Partition(L_SHIPDATE)
select 
L_ORDERKEY,
L_PARTKEY,
L_SUPPKEY,
L_LINENUMBER,
L_QUANTITY,
L_EXTENDEDPRICE,
L_DISCOUNT,
L_TAX,
L_RETURNFLAG,
L_LINESTATUS,
L_COMMITDATE,
L_RECEIPTDATE,
L_SHIPINSTRUCT,
L_SHIPMODE,
L_COMMENT,
L_SHIPDATE
from ${SOURCE}.lineitem;

